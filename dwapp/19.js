(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{462:function(e,t,n){"use strict";n.r(t);var r=monaco.Promise,o=function(){function e(e){var t=this;this._defaults=e,this._worker=null,this._idleCheckInterval=setInterval(function(){return t._checkIfIdle()},3e4),this._lastUsedTime=0,this._configChangeListener=this._defaults.onDidChange(function(){return t._stopWorker()})}return e.prototype._stopWorker=function(){this._worker&&(this._worker.dispose(),this._worker=null),this._client=null},e.prototype.dispose=function(){clearInterval(this._idleCheckInterval),this._configChangeListener.dispose(),this._stopWorker()},e.prototype._checkIfIdle=function(){this._worker&&(Date.now()-this._lastUsedTime>12e4&&this._stopWorker())},e.prototype._getClient=function(){return this._lastUsedTime=Date.now(),this._client||(this._worker=monaco.editor.createWebWorker({moduleId:"vs/language/html/htmlWorker",createData:{languageSettings:this._defaults.options,languageId:this._defaults.languageId},label:this._defaults.languageId}),this._client=this._worker.getProxy()),this._client},e.prototype.getLanguageServiceWorker=function(){for(var e,t,n,o,i,a=this,u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];return t=this._getClient().then(function(t){e=t}).then(function(e){return a._worker.withSyncedResources(u)}).then(function(t){return e}),i=new r(function(e,t){n=e,o=t},function(){}),t.then(n,o),i},e}();var i=n(503),a=(monaco.Uri,monaco.Range),u=function(){function e(e,t,n){var r=this;this._languageId=e,this._worker=t,this._disposables=[],this._listener=Object.create(null);var o=function(e){var t,n=e.getModeId();n===r._languageId&&(r._listener[e.uri.toString()]=e.onDidChangeContent(function(){clearTimeout(t),t=setTimeout(function(){return r._doValidate(e.uri,n)},500)}),r._doValidate(e.uri,n))},i=function(e){monaco.editor.setModelMarkers(e,r._languageId,[]);var t=e.uri.toString(),n=r._listener[t];n&&(n.dispose(),delete r._listener[t])};this._disposables.push(monaco.editor.onDidCreateModel(o)),this._disposables.push(monaco.editor.onWillDisposeModel(function(e){i(e)})),this._disposables.push(monaco.editor.onDidChangeModelLanguage(function(e){i(e.model),o(e.model)})),this._disposables.push(n.onDidChange(function(e){monaco.editor.getModels().forEach(function(e){e.getModeId()===r._languageId&&(i(e),o(e))})})),this._disposables.push({dispose:function(){for(var e in r._listener)r._listener[e].dispose()}}),monaco.editor.getModels().forEach(o)}return e.prototype.dispose=function(){this._disposables.forEach(function(e){return e&&e.dispose()}),this._disposables=[]},e.prototype._doValidate=function(e,t){this._worker(e).then(function(n){return n.doValidation(e.toString()).then(function(n){var r=n.map(function(e){return n="number"==typeof(t=e).code?String(t.code):t.code,{severity:function(e){switch(e){case i.b.Error:return monaco.MarkerSeverity.Error;case i.b.Warning:return monaco.MarkerSeverity.Warning;case i.b.Information:return monaco.MarkerSeverity.Info;case i.b.Hint:return monaco.MarkerSeverity.Hint;default:return monaco.MarkerSeverity.Info}}(t.severity),startLineNumber:t.range.start.line+1,startColumn:t.range.start.character+1,endLineNumber:t.range.end.line+1,endColumn:t.range.end.character+1,message:t.message,code:n,source:t.source};var t,n});monaco.editor.setModelMarkers(monaco.editor.getModel(e),t,r)})}).then(void 0,function(e){console.error(e)})},e}();function s(e){if(e)return{character:e.column-1,line:e.lineNumber-1}}function c(e){if(e)return{start:s(e.getStartPosition()),end:s(e.getEndPosition())}}function l(e){if(e)return new a(e.start.line+1,e.start.character+1,e.end.line+1,e.end.character+1)}function d(e){var t=monaco.languages.CompletionItemKind;switch(e){case i.a.Text:return t.Text;case i.a.Method:return t.Method;case i.a.Function:return t.Function;case i.a.Constructor:return t.Constructor;case i.a.Field:return t.Field;case i.a.Variable:return t.Variable;case i.a.Class:return t.Class;case i.a.Interface:return t.Interface;case i.a.Module:return t.Module;case i.a.Property:return t.Property;case i.a.Unit:return t.Unit;case i.a.Value:return t.Value;case i.a.Enum:return t.Enum;case i.a.Keyword:return t.Keyword;case i.a.Snippet:return t.Snippet;case i.a.Color:return t.Color;case i.a.File:return t.File;case i.a.Reference:return t.Reference}return t.Property}function f(e){if(e)return{range:l(e.range),text:e.newText}}var g=function(){function e(e){this._worker=e}return Object.defineProperty(e.prototype,"triggerCharacters",{get:function(){return[".",":","<",'"',"=","/"]},enumerable:!0,configurable:!0}),e.prototype.provideCompletionItems=function(e,t,n){e.getWordUntilPosition(t);var r=e.uri;return k(n,this._worker(r).then(function(e){return e.doComplete(r.toString(),s(t))}).then(function(e){if(e){var t=e.items.map(function(e){var t={label:e.label,insertText:e.insertText,sortText:e.sortText,filterText:e.filterText,documentation:e.documentation,detail:e.detail,kind:d(e.kind)};return e.textEdit&&(t.range=l(e.textEdit.range),t.insertText=e.textEdit.newText),e.insertTextFormat===i.d.Snippet&&(t.insertText={value:t.insertText}),t});return{isIncomplete:e.isIncomplete,items:t}}}))},e}();var h=function(){function e(e){this._worker=e}return e.prototype.provideDocumentHighlights=function(e,t,n){var r=e.uri;return k(n,this._worker(r).then(function(e){return e.findDocumentHighlights(r.toString(),s(t))}).then(function(e){if(e)return e.map(function(e){return{range:l(e.range),kind:function(e){var t=monaco.languages.DocumentHighlightKind;switch(e){case i.c.Read:return t.Read;case i.c.Write:return t.Write;case i.c.Text:return t.Text}return t.Text}(e.kind)}})}))},e}(),p=function(){function e(e){this._worker=e}return e.prototype.provideLinks=function(e,t){var n=e.uri;return k(t,this._worker(n).then(function(e){return e.findDocumentLinks(n.toString())}).then(function(e){if(e)return e.map(function(e){return{range:l(e.range),url:e.target}})}))},e}();function m(e){return{tabSize:e.tabSize,insertSpaces:e.insertSpaces}}var _=function(){function e(e){this._worker=e}return e.prototype.provideDocumentFormattingEdits=function(e,t,n){var r=e.uri;return k(n,this._worker(r).then(function(e){return e.format(r.toString(),null,m(t)).then(function(e){if(e&&0!==e.length)return e.map(f)})}))},e}(),v=function(){function e(e){this._worker=e}return e.prototype.provideDocumentRangeFormattingEdits=function(e,t,n,r){var o=e.uri;return k(r,this._worker(o).then(function(e){return e.format(o.toString(),c(t),m(n)).then(function(e){if(e&&0!==e.length)return e.map(f)})}))},e}();function k(e,t){return t.cancel&&e.onCancellationRequested(function(){return t.cancel()}),t}function w(e){var t=new o(e),n=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.getLanguageServiceWorker.apply(t,e)},r=e.languageId;monaco.languages.registerCompletionItemProvider(r,new g(n)),monaco.languages.registerDocumentHighlightProvider(r,new h(n)),monaco.languages.registerLinkProvider(r,new p(n)),"html"===r&&(monaco.languages.registerDocumentFormattingEditProvider(r,new _(n)),monaco.languages.registerDocumentRangeFormattingEditProvider(r,new v(n)),new u(r,n,e))}n.d(t,"setupMode",function(){return w})}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvbW9uYWNvLWVkaXRvci9lc20vdnMvbGFuZ3VhZ2UvaHRtbC93b3JrZXJNYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9tb25hY28tZWRpdG9yL2VzbS92cy9sYW5ndWFnZS9odG1sL2xhbmd1YWdlRmVhdHVyZXMuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL21vbmFjby1lZGl0b3IvZXNtL3ZzL2xhbmd1YWdlL2h0bWwvaHRtbE1vZGUuanMiXSwibmFtZXMiOlsiUHJvbWlzZSIsIm1vbmFjbyIsIldvcmtlck1hbmFnZXIiLCJkZWZhdWx0cyIsIl90aGlzIiwidGhpcyIsIl9kZWZhdWx0cyIsIl93b3JrZXIiLCJfaWRsZUNoZWNrSW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsIl9jaGVja0lmSWRsZSIsIl9sYXN0VXNlZFRpbWUiLCJfY29uZmlnQ2hhbmdlTGlzdGVuZXIiLCJvbkRpZENoYW5nZSIsIl9zdG9wV29ya2VyIiwicHJvdG90eXBlIiwiZGlzcG9zZSIsIl9jbGllbnQiLCJjbGVhckludGVydmFsIiwiRGF0ZSIsIm5vdyIsIl9nZXRDbGllbnQiLCJlZGl0b3IiLCJjcmVhdGVXZWJXb3JrZXIiLCJtb2R1bGVJZCIsImNyZWF0ZURhdGEiLCJsYW5ndWFnZVNldHRpbmdzIiwib3B0aW9ucyIsImxhbmd1YWdlSWQiLCJsYWJlbCIsImdldFByb3h5IiwiZ2V0TGFuZ3VhZ2VTZXJ2aWNlV29ya2VyIiwicCIsImNvbXBsZXRlQ2FsbGJhY2siLCJlcnJvckNhbGxiYWNrIiwiciIsInJlc291cmNlcyIsIl9pIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidGhlbiIsImNsaWVudCIsIl8iLCJ3aXRoU3luY2VkUmVzb3VyY2VzIiwiYyIsImUiLCJSYW5nZSIsIlVyaSIsIkRpYWdub3N0aWNzQWRhcHRlciIsIl9sYW5ndWFnZUlkIiwiX2Rpc3Bvc2FibGVzIiwiX2xpc3RlbmVyIiwiT2JqZWN0IiwiY3JlYXRlIiwib25Nb2RlbEFkZCIsIm1vZGVsIiwiaGFuZGxlIiwibW9kZUlkIiwiZ2V0TW9kZUlkIiwidXJpIiwidG9TdHJpbmciLCJvbkRpZENoYW5nZUNvbnRlbnQiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiX2RvVmFsaWRhdGUiLCJvbk1vZGVsUmVtb3ZlZCIsInNldE1vZGVsTWFya2VycyIsInVyaVN0ciIsImxpc3RlbmVyIiwicHVzaCIsIm9uRGlkQ3JlYXRlTW9kZWwiLCJvbldpbGxEaXNwb3NlTW9kZWwiLCJvbkRpZENoYW5nZU1vZGVsTGFuZ3VhZ2UiLCJldmVudCIsImdldE1vZGVscyIsImZvckVhY2giLCJrZXkiLCJkIiwicmVzb3VyY2UiLCJ3b3JrZXIiLCJkb1ZhbGlkYXRpb24iLCJkaWFnbm9zdGljcyIsIm1hcmtlcnMiLCJtYXAiLCJjb2RlIiwiZGlhZyIsIlN0cmluZyIsInNldmVyaXR5IiwibHNTZXZlcml0eSIsIm1haW4iLCJFcnJvciIsIk1hcmtlclNldmVyaXR5IiwiV2FybmluZyIsIkluZm9ybWF0aW9uIiwiSW5mbyIsIkhpbnQiLCJ0b1NldmVyaXR5Iiwic3RhcnRMaW5lTnVtYmVyIiwicmFuZ2UiLCJzdGFydCIsImxpbmUiLCJzdGFydENvbHVtbiIsImNoYXJhY3RlciIsImVuZExpbmVOdW1iZXIiLCJlbmQiLCJlbmRDb2x1bW4iLCJtZXNzYWdlIiwic291cmNlIiwiZ2V0TW9kZWwiLCJ1bmRlZmluZWQiLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJmcm9tUG9zaXRpb24iLCJwb3NpdGlvbiIsImNvbHVtbiIsImxpbmVOdW1iZXIiLCJmcm9tUmFuZ2UiLCJnZXRTdGFydFBvc2l0aW9uIiwiZ2V0RW5kUG9zaXRpb24iLCJ0b1JhbmdlIiwidG9Db21wbGV0aW9uSXRlbUtpbmQiLCJraW5kIiwibUl0ZW1LaW5kIiwibGFuZ3VhZ2VzIiwiQ29tcGxldGlvbkl0ZW1LaW5kIiwiVGV4dCIsIk1ldGhvZCIsIkZ1bmN0aW9uIiwiQ29uc3RydWN0b3IiLCJGaWVsZCIsIlZhcmlhYmxlIiwiQ2xhc3MiLCJJbnRlcmZhY2UiLCJNb2R1bGUiLCJQcm9wZXJ0eSIsIlVuaXQiLCJWYWx1ZSIsIkVudW0iLCJLZXl3b3JkIiwiU25pcHBldCIsIkNvbG9yIiwiRmlsZSIsIlJlZmVyZW5jZSIsInRvVGV4dEVkaXQiLCJ0ZXh0RWRpdCIsInRleHQiLCJuZXdUZXh0IiwibGFuZ3VhZ2VGZWF0dXJlc19Db21wbGV0aW9uQWRhcHRlciIsIkNvbXBsZXRpb25BZGFwdGVyIiwiZGVmaW5lUHJvcGVydHkiLCJnZXQiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwicHJvdmlkZUNvbXBsZXRpb25JdGVtcyIsInRva2VuIiwiZ2V0V29yZFVudGlsUG9zaXRpb24iLCJ3aXJlQ2FuY2VsbGF0aW9uVG9rZW4iLCJkb0NvbXBsZXRlIiwiaW5mbyIsIml0ZW1zIiwiZW50cnkiLCJpdGVtIiwiaW5zZXJ0VGV4dCIsInNvcnRUZXh0IiwiZmlsdGVyVGV4dCIsImRvY3VtZW50YXRpb24iLCJkZXRhaWwiLCJpbnNlcnRUZXh0Rm9ybWF0IiwidmFsdWUiLCJpc0luY29tcGxldGUiLCJEb2N1bWVudEhpZ2hsaWdodEFkYXB0ZXIiLCJwcm92aWRlRG9jdW1lbnRIaWdobGlnaHRzIiwiZmluZERvY3VtZW50SGlnaGxpZ2h0cyIsIm1LaW5kIiwiRG9jdW1lbnRIaWdobGlnaHRLaW5kIiwiUmVhZCIsIldyaXRlIiwidG9IaWdobGlnaEtpbmQiLCJEb2N1bWVudExpbmtBZGFwdGVyIiwicHJvdmlkZUxpbmtzIiwiZmluZERvY3VtZW50TGlua3MiLCJ1cmwiLCJ0YXJnZXQiLCJmcm9tRm9ybWF0dGluZ09wdGlvbnMiLCJ0YWJTaXplIiwiaW5zZXJ0U3BhY2VzIiwiRG9jdW1lbnRGb3JtYXR0aW5nRWRpdFByb3ZpZGVyIiwicHJvdmlkZURvY3VtZW50Rm9ybWF0dGluZ0VkaXRzIiwiZm9ybWF0IiwiZWRpdHMiLCJEb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRQcm92aWRlciIsInByb3ZpZGVEb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRzIiwicHJvbWlzZSIsImNhbmNlbCIsIm9uQ2FuY2VsbGF0aW9uUmVxdWVzdGVkIiwic2V0dXBNb2RlIiwidXJpcyIsImFwcGx5IiwicmVnaXN0ZXJDb21wbGV0aW9uSXRlbVByb3ZpZGVyIiwicmVnaXN0ZXJEb2N1bWVudEhpZ2hsaWdodFByb3ZpZGVyIiwicmVnaXN0ZXJMaW5rUHJvdmlkZXIiLCJyZWdpc3RlckRvY3VtZW50Rm9ybWF0dGluZ0VkaXRQcm92aWRlciIsInJlZ2lzdGVyRG9jdW1lbnRSYW5nZUZvcm1hdHRpbmdFZGl0UHJvdmlkZXIiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiX193ZWJwYWNrX2V4cG9ydHNfXyJdLCJtYXBwaW5ncyI6ImtHQUtBLElBQUFBLEVBQUFDLE9BQUFELFFBRUFFLEVBQUEsV0FDQSxTQUFBQSxFQUFBQyxHQUNBLElBQUFDLEVBQUFDLEtBQ0FBLEtBQUFDLFVBQUFILEVBQ0FFLEtBQUFFLFFBQUEsS0FDQUYsS0FBQUcsbUJBQUFDLFlBQUEsV0FBMkQsT0FBQUwsRUFBQU0sZ0JBQStCLEtBQzFGTCxLQUFBTSxjQUFBLEVBQ0FOLEtBQUFPLHNCQUFBUCxLQUFBQyxVQUFBTyxZQUFBLFdBQTZFLE9BQUFULEVBQUFVLGdCQXFEN0UsT0FuREFaLEVBQUFhLFVBQUFELFlBQUEsV0FDQVQsS0FBQUUsVUFDQUYsS0FBQUUsUUFBQVMsVUFDQVgsS0FBQUUsUUFBQSxNQUVBRixLQUFBWSxRQUFBLE1BRUFmLEVBQUFhLFVBQUFDLFFBQUEsV0FDQUUsY0FBQWIsS0FBQUcsb0JBQ0FILEtBQUFPLHNCQUFBSSxVQUNBWCxLQUFBUyxlQUVBWixFQUFBYSxVQUFBTCxhQUFBLFdBQ0FMLEtBQUFFLFVBR0FZLEtBQUFDLE1BQUFmLEtBQUFNLGNBMUJBLE1BNEJBTixLQUFBUyxnQkFHQVosRUFBQWEsVUFBQU0sV0FBQSxXQWVBLE9BZEFoQixLQUFBTSxjQUFBUSxLQUFBQyxNQUNBZixLQUFBWSxVQUNBWixLQUFBRSxRQUFBTixPQUFBcUIsT0FBQUMs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eUJBQUF1SyxNQUFBN0osRUFBQTRKLElBRUF6SyxFQUFBekIsRUFBQXlCLFdBRUEzQixPQUFBMkgsVUFBQTJFLCtCQUFBM0ssRUFBQSxJQUFBd0gsRUFBQXJFLElBQ0E5RSxPQUFBMkgsVUFBQTRFLGtDQUFBNUssRUFBQSxJQUFBK0ksRUFBQTVGLElBQ0E5RSxPQUFBMkgsVUFBQTZFLHFCQUFBN0ssRUFBQSxJQUFBdUosRUFBQXBHLElBRUEsU0FBQW5ELElBQ0EzQixPQUFBMkgsVUFBQThFLHVDQUFBOUssRUFBQSxJQUFBK0osRUFBQTVHLElBQ0E5RSxPQUFBMkgsVUFBQStFLDRDQUFBL0ssRUFBQSxJQUFBbUssRUFBQWhILElBQ0EsSUFBQS9CLEVBQUFwQixFQUFBbUQsRUFBQTVFLElBekJBeU0sRUFBQS9ILEVBQUFnSSxFQUFBLDhCQUFBVCIsImZpbGUiOiIxOS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuJ3VzZSBzdHJpY3QnO1xudmFyIFByb21pc2UgPSBtb25hY28uUHJvbWlzZTtcbnZhciBTVE9QX1dIRU5fSURMRV9GT1IgPSAyICogNjAgKiAxMDAwOyAvLyAybWluXG52YXIgV29ya2VyTWFuYWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBXb3JrZXJNYW5hZ2VyKGRlZmF1bHRzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuX2RlZmF1bHRzID0gZGVmYXVsdHM7XG4gICAgICAgIHRoaXMuX3dvcmtlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX2lkbGVDaGVja0ludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX2NoZWNrSWZJZGxlKCk7IH0sIDMwICogMTAwMCk7XG4gICAgICAgIHRoaXMuX2xhc3RVc2VkVGltZSA9IDA7XG4gICAgICAgIHRoaXMuX2NvbmZpZ0NoYW5nZUxpc3RlbmVyID0gdGhpcy5fZGVmYXVsdHMub25EaWRDaGFuZ2UoZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMuX3N0b3BXb3JrZXIoKTsgfSk7XG4gICAgfVxuICAgIFdvcmtlck1hbmFnZXIucHJvdG90eXBlLl9zdG9wV29ya2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5fd29ya2VyKSB7XG4gICAgICAgICAgICB0aGlzLl93b3JrZXIuZGlzcG9zZSgpO1xuICAgICAgICAgICAgdGhpcy5fd29ya2VyID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLl9jbGllbnQgPSBudWxsO1xuICAgIH07XG4gICAgV29ya2VyTWFuYWdlci5wcm90b3R5cGUuZGlzcG9zZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLl9pZGxlQ2hlY2tJbnRlcnZhbCk7XG4gICAgICAgIHRoaXMuX2NvbmZpZ0NoYW5nZUxpc3RlbmVyLmRpc3Bvc2UoKTtcbiAgICAgICAgdGhpcy5fc3RvcFdvcmtlcigpO1xuICAgIH07XG4gICAgV29ya2VyTWFuYWdlci5wcm90b3R5cGUuX2NoZWNrSWZJZGxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3dvcmtlcikge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0aW1lUGFzc2VkU2luY2VMYXN0VXNlZCA9IERhdGUubm93KCkgLSB0aGlzLl9sYXN0VXNlZFRpbWU7XG4gICAgICAgIGlmICh0aW1lUGFzc2VkU2luY2VMYXN0VXNlZCA+IFNUT1BfV0hFTl9JRExFX0ZPUikge1xuICAgICAgICAgICAgdGhpcy5fc3RvcFdvcmtlcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBXb3JrZXJNYW5hZ2VyLnByb3RvdHlwZS5fZ2V0Q2xpZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLl9sYXN0VXNlZFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgICBpZiAoIXRoaXMuX2NsaWVudCkge1xuICAgICAgICAgICAgdGhpcy5fd29ya2VyID0gbW9uYWNvLmVkaXRvci5jcmVhdGVXZWJXb3JrZXIoe1xuICAgICAgICAgICAgICAgIC8vIG1vZHVsZSB0aGF0IGV4cG9ydHMgdGhlIGNyZWF0ZSgpIG1ldGhvZCBhbmQgcmV0dXJucyBhIGBIVE1MV29ya2VyYCBpbnN0YW5jZVxuICAgICAgICAgICAgICAgIG1vZHVsZUlkOiAndnMvbGFuZ3VhZ2UvaHRtbC9odG1sV29ya2VyJyxcbiAgICAgICAgICAgICAgICAvLyBwYXNzZWQgaW4gdG8gdGhlIGNyZWF0ZSgpIG1ldGhvZFxuICAgICAgICAgICAgICAgIGNyZWF0ZURhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2VTZXR0aW5nczogdGhpcy5fZGVmYXVsdHMub3B0aW9ucyxcbiAgICAgICAgICAgICAgICAgICAgbGFuZ3VhZ2VJZDogdGhpcy5fZGVmYXVsdHMubGFuZ3VhZ2VJZFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgbGFiZWw6IHRoaXMuX2RlZmF1bHRzLmxhbmd1YWdlSWRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fY2xpZW50ID0gdGhpcy5fd29ya2VyLmdldFByb3h5KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2NsaWVudDtcbiAgICB9O1xuICAgIFdvcmtlck1hbmFnZXIucHJvdG90eXBlLmdldExhbmd1YWdlU2VydmljZVdvcmtlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHJlc291cmNlcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgcmVzb3VyY2VzW19pXSA9IGFyZ3VtZW50c1tfaV07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIF9jbGllbnQ7XG4gICAgICAgIHJldHVybiB0b1NoYWxsb3dDYW5jZWxQcm9taXNlKHRoaXMuX2dldENsaWVudCgpLnRoZW4oZnVuY3Rpb24gKGNsaWVudCkge1xuICAgICAgICAgICAgX2NsaWVudCA9IGNsaWVudDtcbiAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoXykge1xuICAgICAgICAgICAgcmV0dXJuIF90aGlzLl93b3JrZXIud2l0aFN5bmNlZFJlc291cmNlcyhyZXNvdXJjZXMpO1xuICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChfKSB7IHJldHVybiBfY2xpZW50OyB9KSk7XG4gICAgfTtcbiAgICByZXR1cm4gV29ya2VyTWFuYWdlcjtcbn0oKSk7XG5leHBvcnQgeyBXb3JrZXJNYW5hZ2VyIH07XG5mdW5jdGlvbiB0b1NoYWxsb3dDYW5jZWxQcm9taXNlKHApIHtcbiAgICB2YXIgY29tcGxldGVDYWxsYmFjaztcbiAgICB2YXIgZXJyb3JDYWxsYmFjaztcbiAgICB2YXIgciA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChjLCBlKSB7XG4gICAgICAgIGNvbXBsZXRlQ2FsbGJhY2sgPSBjO1xuICAgICAgICBlcnJvckNhbGxiYWNrID0gZTtcbiAgICB9LCBmdW5jdGlvbiAoKSB7IH0pO1xuICAgIHAudGhlbihjb21wbGV0ZUNhbGxiYWNrLCBlcnJvckNhbGxiYWNrKTtcbiAgICByZXR1cm4gcjtcbn1cbiIsIi8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiAgQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cbiAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuJ3VzZSBzdHJpY3QnO1xuaW1wb3J0ICogYXMgbHMgZnJvbSAnLi9fZGVwcy92c2NvZGUtbGFuZ3VhZ2VzZXJ2ZXItdHlwZXMvbWFpbi5qcyc7XG52YXIgVXJpID0gbW9uYWNvLlVyaTtcbnZhciBSYW5nZSA9IG1vbmFjby5SYW5nZTtcbi8vIC0tLSBkaWFnbm9zdGljcyAtLS0gLS0tXG52YXIgRGlhZ25vc3RpY3NBZGFwdGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIERpYWdub3N0aWNzQWRhcHRlcihfbGFuZ3VhZ2VJZCwgX3dvcmtlciwgZGVmYXVsdHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5fbGFuZ3VhZ2VJZCA9IF9sYW5ndWFnZUlkO1xuICAgICAgICB0aGlzLl93b3JrZXIgPSBfd29ya2VyO1xuICAgICAgICB0aGlzLl9kaXNwb3NhYmxlcyA9IFtdO1xuICAgICAgICB0aGlzLl9saXN0ZW5lciA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgICAgIHZhciBvbk1vZGVsQWRkID0gZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgICAgICB2YXIgbW9kZUlkID0gbW9kZWwuZ2V0TW9kZUlkKCk7XG4gICAgICAgICAgICBpZiAobW9kZUlkICE9PSBfdGhpcy5fbGFuZ3VhZ2VJZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBoYW5kbGU7XG4gICAgICAgICAgICBfdGhpcy5fbGlzdGVuZXJbbW9kZWwudXJpLnRvU3RyaW5nKCldID0gbW9kZWwub25EaWRDaGFuZ2VDb250ZW50KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQoaGFuZGxlKTtcbiAgICAgICAgICAgICAgICBoYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLl9kb1ZhbGlkYXRlKG1vZGVsLnVyaSwgbW9kZUlkKTsgfSwgNTAwKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgX3RoaXMuX2RvVmFsaWRhdGUobW9kZWwudXJpLCBtb2RlSWQpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgb25Nb2RlbFJlbW92ZWQgPSBmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgIG1vbmFjby5lZGl0b3Iuc2V0TW9kZWxNYXJrZXJzKG1vZGVsLCBfdGhpcy5fbGFuZ3VhZ2VJZCwgW10pO1xuICAgICAgICAgICAgdmFyIHVyaVN0ciA9IG1vZGVsLnVyaS50b1N0cmluZygpO1xuICAgICAgICAgICAgdmFyIGxpc3RlbmVyID0gX3RoaXMuX2xpc3RlbmVyW3VyaVN0cl07XG4gICAgICAgICAgICBpZiAobGlzdGVuZXIpIHtcbiAgICAgICAgICAgICAgICBsaXN0ZW5lci5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgZGVsZXRlIF90aGlzLl9saXN0ZW5lclt1cmlTdHJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9kaXNwb3NhYmxlcy5wdXNoKG1vbmFjby5lZGl0b3Iub25EaWRDcmVhdGVNb2RlbChvbk1vZGVsQWRkKSk7XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2FibGVzLnB1c2gobW9uYWNvLmVkaXRvci5vbldpbGxEaXNwb3NlTW9kZWwoZnVuY3Rpb24gKG1vZGVsKSB7XG4gICAgICAgICAgICBvbk1vZGVsUmVtb3ZlZChtb2RlbCk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5fZGlzcG9zYWJsZXMucHVzaChtb25hY28uZWRpdG9yLm9uRGlkQ2hhbmdlTW9kZWxMYW5ndWFnZShmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIG9uTW9kZWxSZW1vdmVkKGV2ZW50Lm1vZGVsKTtcbiAgICAgICAgICAgIG9uTW9kZWxBZGQoZXZlbnQubW9kZWwpO1xuICAgICAgICB9KSk7XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2FibGVzLnB1c2goZGVmYXVsdHMub25EaWRDaGFuZ2UoZnVuY3Rpb24gKF8pIHtcbiAgICAgICAgICAgIG1vbmFjby5lZGl0b3IuZ2V0TW9kZWxzKCkuZm9yRWFjaChmdW5jdGlvbiAobW9kZWwpIHtcbiAgICAgICAgICAgICAgICBpZiAobW9kZWwuZ2V0TW9kZUlkKCkgPT09IF90aGlzLl9sYW5ndWFnZUlkKSB7XG4gICAgICAgICAgICAgICAgICAgIG9uTW9kZWxSZW1vdmVkKG1vZGVsKTtcbiAgICAgICAgICAgICAgICAgICAgb25Nb2RlbEFkZChtb2RlbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgdGhpcy5fZGlzcG9zYWJsZXMucHVzaCh7XG4gICAgICAgICAgICBkaXNwb3NlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIF90aGlzLl9saXN0ZW5lcikge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbGlzdGVuZXJba2V5XS5kaXNwb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbW9uYWNvLmVkaXRvci5nZXRNb2RlbHMoKS5mb3JFYWNoKG9uTW9kZWxBZGQpO1xuICAgIH1cbiAgICBEaWFnbm9zdGljc0FkYXB0ZXIucHJvdG90eXBlLmRpc3Bvc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuX2Rpc3Bvc2FibGVzLmZvckVhY2goZnVuY3Rpb24gKGQpIHsgcmV0dXJuIGQgJiYgZC5kaXNwb3NlKCk7IH0pO1xuICAgICAgICB0aGlzLl9kaXNwb3NhYmxlcyA9IFtdO1xuICAgIH07XG4gICAgRGlhZ25vc3RpY3NBZGFwdGVyLnByb3RvdHlwZS5fZG9WYWxpZGF0ZSA9IGZ1bmN0aW9uIChyZXNvdXJjZSwgbGFuZ3VhZ2VJZCkge1xuICAgICAgICB0aGlzLl93b3JrZXIocmVzb3VyY2UpLnRoZW4oZnVuY3Rpb24gKHdvcmtlcikge1xuICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5kb1ZhbGlkYXRpb24ocmVzb3VyY2UudG9TdHJpbmcoKSkudGhlbihmdW5jdGlvbiAoZGlhZ25vc3RpY3MpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWFya2VycyA9IGRpYWdub3N0aWNzLm1hcChmdW5jdGlvbiAoZCkgeyByZXR1cm4gdG9EaWFnbm9zdGljcyhyZXNvdXJjZSwgZCk7IH0pO1xuICAgICAgICAgICAgICAgIG1vbmFjby5lZGl0b3Iuc2V0TW9kZWxNYXJrZXJzKG1vbmFjby5lZGl0b3IuZ2V0TW9kZWwocmVzb3VyY2UpLCBsYW5ndWFnZUlkLCBtYXJrZXJzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KS50aGVuKHVuZGVmaW5lZCwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBEaWFnbm9zdGljc0FkYXB0ZXI7XG59KCkpO1xuZXhwb3J0IHsgRGlhZ25vc3RpY3NBZGFwdGVyIH07XG5mdW5jdGlvbiB0b1NldmVyaXR5KGxzU2V2ZXJpdHkpIHtcbiAgICBzd2l0Y2ggKGxzU2V2ZXJpdHkpIHtcbiAgICAgICAgY2FzZSBscy5EaWFnbm9zdGljU2V2ZXJpdHkuRXJyb3I6IHJldHVybiBtb25hY28uTWFya2VyU2V2ZXJpdHkuRXJyb3I7XG4gICAgICAgIGNhc2UgbHMuRGlhZ25vc3RpY1NldmVyaXR5Lldhcm5pbmc6IHJldHVybiBtb25hY28uTWFya2VyU2V2ZXJpdHkuV2FybmluZztcbiAgICAgICAgY2FzZSBscy5EaWFnbm9zdGljU2V2ZXJpdHkuSW5mb3JtYXRpb246IHJldHVybiBtb25hY28uTWFya2VyU2V2ZXJpdHkuSW5mbztcbiAgICAgICAgY2FzZSBscy5EaWFnbm9zdGljU2V2ZXJpdHkuSGludDogcmV0dXJuIG1vbmFjby5NYXJrZXJTZXZlcml0eS5IaW50O1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIG1vbmFjby5NYXJrZXJTZXZlcml0eS5JbmZvO1xuICAgIH1cbn1cbmZ1bmN0aW9uIHRvRGlhZ25vc3RpY3MocmVzb3VyY2UsIGRpYWcpIHtcbiAgICB2YXIgY29kZSA9IHR5cGVvZiBkaWFnLmNvZGUgPT09ICdudW1iZXInID8gU3RyaW5nKGRpYWcuY29kZSkgOiBkaWFnLmNvZGU7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2V2ZXJpdHk6IHRvU2V2ZXJpdHkoZGlhZy5zZXZlcml0eSksXG4gICAgICAgIHN0YXJ0TGluZU51bWJlcjogZGlhZy5yYW5nZS5zdGFydC5saW5lICsgMSxcbiAgICAgICAgc3RhcnRDb2x1bW46IGRpYWcucmFuZ2Uuc3RhcnQuY2hhcmFjdGVyICsgMSxcbiAgICAgICAgZW5kTGluZU51bWJlcjogZGlhZy5yYW5nZS5lbmQubGluZSArIDEsXG4gICAgICAgIGVuZENvbHVtbjogZGlhZy5yYW5nZS5lbmQuY2hhcmFjdGVyICsgMSxcbiAgICAgICAgbWVzc2FnZTogZGlhZy5tZXNzYWdlLFxuICAgICAgICBjb2RlOiBjb2RlLFxuICAgICAgICBzb3VyY2U6IGRpYWcuc291cmNlXG4gICAgfTtcbn1cbi8vIC0tLSBjb21wbGV0aW9uIC0tLS0tLVxuZnVuY3Rpb24gZnJvbVBvc2l0aW9uKHBvc2l0aW9uKSB7XG4gICAgaWYgKCFwb3NpdGlvbikge1xuICAgICAgICByZXR1cm4gdm9pZCAwO1xuICAgIH1cbiAgICByZXR1cm4geyBjaGFyYWN0ZXI6IHBvc2l0aW9uLmNvbHVtbiAtIDEsIGxpbmU6IHBvc2l0aW9uLmxpbmVOdW1iZXIgLSAxIH07XG59XG5mdW5jdGlvbiBmcm9tUmFuZ2UocmFuZ2UpIHtcbiAgICBpZiAoIXJhbmdlKSB7XG4gICAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfVxuICAgIHJldHVybiB7IHN0YXJ0OiBmcm9tUG9zaXRpb24ocmFuZ2UuZ2V0U3RhcnRQb3NpdGlvbigpKSwgZW5kOiBmcm9tUG9zaXRpb24ocmFuZ2UuZ2V0RW5kUG9zaXRpb24oKSkgfTtcbn1cbmZ1bmN0aW9uIHRvUmFuZ2UocmFuZ2UpIHtcbiAgICBpZiAoIXJhbmdlKSB7XG4gICAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfVxuICAgIHJldHVybiBuZXcgUmFuZ2UocmFuZ2Uuc3RhcnQubGluZSArIDEsIHJhbmdlLnN0YXJ0LmNoYXJhY3RlciArIDEsIHJhbmdlLmVuZC5saW5lICsgMSwgcmFuZ2UuZW5kLmNoYXJhY3RlciArIDEpO1xufVxuZnVuY3Rpb24gdG9Db21wbGV0aW9uSXRlbUtpbmQoa2luZCkge1xuICAgIHZhciBtSXRlbUtpbmQgPSBtb25hY28ubGFuZ3VhZ2VzLkNvbXBsZXRpb25JdGVtS2luZDtcbiAgICBzd2l0Y2ggKGtpbmQpIHtcbiAgICAgICAgY2FzZSBscy5Db21wbGV0aW9uSXRlbUtpbmQuVGV4dDogcmV0dXJuIG1JdGVtS2luZC5UZXh0O1xuICAgICAgICBjYXNlIGxzLkNvbXBsZXRpb25JdGVtS2luZC5NZXRob2Q6IHJldHVybiBtSXRlbUtpbmQuTWV0aG9kO1xuICAgICAgICBjYXNlIGxzLkNvbXBsZXRpb25JdGVtS2luZC5GdW5jdGlvbjogcmV0dXJuIG1JdGVtS2luZC5GdW5jdGlvbjtcbiAgICAgICAgY2FzZSBscy5Db21wbGV0aW9uSXRlbUtpbmQuQ29uc3RydWN0b3I6IHJldHVybiBtSXRlbUtpbmQuQ29uc3RydWN0b3I7XG4gICAgICAgIGNhc2UgbHMuQ29tcGxldGlvbkl0ZW1LaW5kLkZpZWxkOiByZXR1cm4gbUl0ZW1LaW5kLkZpZWxkO1xuICAgICAgICBjYXNlIGxzLkNvbXBsZXRpb25JdGVtS2luZC5WYXJpYWJsZTogcmV0dXJuIG1JdGVtS2luZC5WYXJpYWJsZTtcbiAgICAgICAgY2FzZSBscy5Db21wbGV0aW9uSXRlbUtpbmQuQ2xhc3M6IHJldHVybiBtSXRlbUtpbmQuQ2xhc3M7XG4gICAgICAgIGNhc2UgbHMuQ29tcGxldGlvbkl0ZW1LaW5kLkludGVyZmFjZTogcmV0dXJuIG1JdGVtS2luZC5JbnRlcmZhY2U7XG4gICAgICAgIGNhc2UgbHMuQ29tcGxldGlvbkl0ZW1LaW5kLk1vZHVsZTogcmV0dXJuIG1JdGVtS2luZC5Nb2R1bGU7XG4gICAgICAgIGNhc2UgbHMuQ29tcGxldGlvbkl0ZW1LaW5kLlByb3BlcnR5OiByZXR1cm4gbUl0ZW1LaW5kLlByb3BlcnR5O1xuICAgICAgICBjYXNlIGxzLkNvbXBsZXRpb25JdGVtS2luZC5Vbml0OiByZXR1cm4gbUl0ZW1LaW5kLlVuaXQ7XG4gICAgICAgIGNhc2UgbHMuQ29tcGxldGlvbkl0ZW1LaW5kLlZhbHVlOiByZXR1cm4gbUl0ZW1LaW5kLlZhbHVlO1xuICAgICAgICBjYXNlIGxzLkNvbXBsZXRpb25JdGVtS2luZC5FbnVtOiByZXR1cm4gbUl0ZW1LaW5kLkVudW07XG4gICAgICAgIGNhc2UgbHMuQ29tcGxldGlvbkl0ZW1LaW5kLktleXdvcmQ6IHJldHVybiBtSXRlbUtpbmQuS2V5d29yZDtcbiAgICAgICAgY2FzZSBscy5Db21wbGV0aW9uSXRlbUtpbmQuU25pcHBldDogcmV0dXJuIG1JdGVtS2luZC5TbmlwcGV0O1xuICAgICAgICBjYXNlIGxzLkNvbXBsZXRpb25JdGVtS2luZC5Db2xvcjogcmV0dXJuIG1JdGVtS2luZC5Db2xvcjtcbiAgICAgICAgY2FzZSBscy5Db21wbGV0aW9uSXRlbUtpbmQuRmlsZTogcmV0dXJuIG1JdGVtS2luZC5GaWxlO1xuICAgICAgICBjYXNlIGxzLkNvbXBsZXRpb25JdGVtS2luZC5SZWZlcmVuY2U6IHJldHVybiBtSXRlbUtpbmQuUmVmZXJlbmNlO1xuICAgIH1cbiAgICByZXR1cm4gbUl0ZW1LaW5kLlByb3BlcnR5O1xufVxuZnVuY3Rpb24gZnJvbUNvbXBsZXRpb25JdGVtS2luZChraW5kKSB7XG4gICAgdmFyIG1JdGVtS2luZCA9IG1vbmFjby5sYW5ndWFnZXMuQ29tcGxldGlvbkl0ZW1LaW5kO1xuICAgIHN3aXRjaCAoa2luZCkge1xuICAgICAgICBjYXNlIG1JdGVtS2luZC5UZXh0OiByZXR1cm4gbHMuQ29tcGxldGlvbkl0ZW1LaW5kLlRleHQ7XG4gICAgICAgIGNhc2UgbUl0ZW1LaW5kLk1ldGhvZDogcmV0dXJuIGxzLkNvbXBsZXRpb25JdGVtS2luZC5NZXRob2Q7XG4gICAgICAgIGNhc2UgbUl0ZW1LaW5kLkZ1bmN0aW9uOiByZXR1cm4gbHMuQ29tcGxldGlvbkl0ZW1LaW5kLkZ1bmN0aW9uO1xuICAgICAgICBjYXNlIG1JdGVtS2luZC5Db25zdHJ1Y3RvcjogcmV0dXJuIGxzLkNvbXBsZXRpb25JdGVtS2luZC5Db25zdHJ1Y3RvcjtcbiAgICAgICAgY2FzZSBtSXRlbUtpbmQuRmllbGQ6IHJldHVybiBscy5Db21wbGV0aW9uSXRlbUtpbmQuRmllbGQ7XG4gICAgICAgIGNhc2UgbUl0ZW1LaW5kLlZhcmlhYmxlOiByZXR1cm4gbHMuQ29tcGxldGlvbkl0ZW1LaW5kLlZhcmlhYmxlO1xuICAgICAgICBjYXNlIG1JdGVtS2luZC5DbGFzczogcmV0dXJuIGxzLkNvbXBsZXRpb25JdGVtS2luZC5DbGFzcztcbiAgICAgICAgY2FzZSBtSXRlbUtpbmQuSW50ZXJmYWNlOiByZXR1cm4gbHMuQ29tcGxldGlvbkl0ZW1LaW5kLkludGVyZmFjZTtcbiAgICAgICAgY2FzZSBtSXRlbUtpbmQuTW9kdWxlOiByZXR1cm4gbHMuQ29tcGxldGlvbkl0ZW1LaW5kLk1vZHVsZTtcbiAgICAgICAgY2FzZSBtSXRlbUtpbmQuUHJvcGVydHk6IHJldHVybiBscy5Db21wbGV0aW9uSXRlbUtpbmQuUHJvcGVydHk7XG4gICAgICAgIGNhc2UgbUl0ZW1LaW5kLlVuaXQ6IHJldHVybiBscy5Db21wbGV0aW9uSXRlbUtpbmQuVW5pdDtcbiAgICAgICAgY2FzZSBtSXRlbUtpbmQuVmFsdWU6IHJldHVybiBscy5Db21wbGV0aW9uSXRlbUtpbmQuVmFsdWU7XG4gICAgICAgIGNhc2UgbUl0ZW1LaW5kLkVudW06IHJldHVybiBscy5Db21wbGV0aW9uSXRlbUtpbmQuRW51bTtcbiAgICAgICAgY2FzZSBtSXRlbUtpbmQuS2V5d29yZDogcmV0dXJuIGxzLkNvbXBsZXRpb25JdGVtS2luZC5LZXl3b3JkO1xuICAgICAgICBjYXNlIG1JdGVtS2luZC5TbmlwcGV0OiByZXR1cm4gbHMuQ29tcGxldGlvbkl0ZW1LaW5kLlNuaXBwZXQ7XG4gICAgICAgIGNhc2UgbUl0ZW1LaW5kLkNvbG9yOiByZXR1cm4gbHMuQ29tcGxldGlvbkl0ZW1LaW5kLkNvbG9yO1xuICAgICAgICBjYXNlIG1JdGVtS2luZC5GaWxlOiByZXR1cm4gbHMuQ29tcGxldGlvbkl0ZW1LaW5kLkZpbGU7XG4gICAgICAgIGNhc2UgbUl0ZW1LaW5kLlJlZmVyZW5jZTogcmV0dXJuIGxzLkNvbXBsZXRpb25JdGVtS2luZC5SZWZlcmVuY2U7XG4gICAgfVxuICAgIHJldHVybiBscy5Db21wbGV0aW9uSXRlbUtpbmQuUHJvcGVydHk7XG59XG5mdW5jdGlvbiB0b1RleHRFZGl0KHRleHRFZGl0KSB7XG4gICAgaWYgKCF0ZXh0RWRpdCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICByYW5nZTogdG9SYW5nZSh0ZXh0RWRpdC5yYW5nZSksXG4gICAgICAgIHRleHQ6IHRleHRFZGl0Lm5ld1RleHRcbiAgICB9O1xufVxuZnVuY3Rpb24gdG9Db21wbGV0aW9uSXRlbShlbnRyeSkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGxhYmVsOiBlbnRyeS5sYWJlbCxcbiAgICAgICAgaW5zZXJ0VGV4dDogZW50cnkuaW5zZXJ0VGV4dCxcbiAgICAgICAgc29ydFRleHQ6IGVudHJ5LnNvcnRUZXh0LFxuICAgICAgICBmaWx0ZXJUZXh0OiBlbnRyeS5maWx0ZXJUZXh0LFxuICAgICAgICBkb2N1bWVudGF0aW9uOiBlbnRyeS5kb2N1bWVudGF0aW9uLFxuICAgICAgICBkZXRhaWw6IGVudHJ5LmRldGFpbCxcbiAgICAgICAga2luZDogdG9Db21wbGV0aW9uSXRlbUtpbmQoZW50cnkua2luZCksXG4gICAgICAgIHRleHRFZGl0OiB0b1RleHRFZGl0KGVudHJ5LnRleHRFZGl0KSxcbiAgICAgICAgZGF0YTogZW50cnkuZGF0YVxuICAgIH07XG59XG5mdW5jdGlvbiBmcm9tTWFya2Rvd25TdHJpbmcoZW50cnkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBraW5kOiAodHlwZW9mIGVudHJ5ID09PSAnc3RyaW5nJyA/IGxzLk1hcmt1cEtpbmQuUGxhaW5UZXh0IDogbHMuTWFya3VwS2luZC5NYXJrZG93biksXG4gICAgICAgIHZhbHVlOiAodHlwZW9mIGVudHJ5ID09PSAnc3RyaW5nJyA/IGVudHJ5IDogZW50cnkudmFsdWUpXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGZyb21Db21wbGV0aW9uSXRlbShlbnRyeSkge1xuICAgIHZhciBpdGVtID0ge1xuICAgICAgICBsYWJlbDogZW50cnkubGFiZWwsXG4gICAgICAgIHNvcnRUZXh0OiBlbnRyeS5zb3J0VGV4dCxcbiAgICAgICAgZmlsdGVyVGV4dDogZW50cnkuZmlsdGVyVGV4dCxcbiAgICAgICAgZG9jdW1lbnRhdGlvbjogZnJvbU1hcmtkb3duU3RyaW5nKGVudHJ5LmRvY3VtZW50YXRpb24pLFxuICAgICAgICBkZXRhaWw6IGVudHJ5LmRldGFpbCxcbiAgICAgICAga2luZDogZnJvbUNvbXBsZXRpb25JdGVtS2luZChlbnRyeS5raW5kKSxcbiAgICAgICAgZGF0YTogZW50cnkuZGF0YVxuICAgIH07XG4gICAgaWYgKHR5cGVvZiBlbnRyeS5pbnNlcnRUZXh0ID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgZW50cnkuaW5zZXJ0VGV4dC52YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaXRlbS5pbnNlcnRUZXh0ID0gZW50cnkuaW5zZXJ0VGV4dC52YWx1ZTtcbiAgICAgICAgaXRlbS5pbnNlcnRUZXh0Rm9ybWF0ID0gbHMuSW5zZXJ0VGV4dEZvcm1hdC5TbmlwcGV0O1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgaXRlbS5pbnNlcnRUZXh0ID0gZW50cnkuaW5zZXJ0VGV4dDtcbiAgICB9XG4gICAgaWYgKGVudHJ5LnJhbmdlKSB7XG4gICAgICAgIGl0ZW0udGV4dEVkaXQgPSBscy5UZXh0RWRpdC5yZXBsYWNlKGZyb21SYW5nZShlbnRyeS5yYW5nZSksIGl0ZW0uaW5zZXJ0VGV4dCk7XG4gICAgfVxuICAgIHJldHVybiBpdGVtO1xufVxudmFyIENvbXBsZXRpb25BZGFwdGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIENvbXBsZXRpb25BZGFwdGVyKF93b3JrZXIpIHtcbiAgICAgICAgdGhpcy5fd29ya2VyID0gX3dvcmtlcjtcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KENvbXBsZXRpb25BZGFwdGVyLnByb3RvdHlwZSwgXCJ0cmlnZ2VyQ2hhcmFjdGVyc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIFsnLicsICc6JywgJzwnLCAnXCInLCAnPScsICcvJ107XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIENvbXBsZXRpb25BZGFwdGVyLnByb3RvdHlwZS5wcm92aWRlQ29tcGxldGlvbkl0ZW1zID0gZnVuY3Rpb24gKG1vZGVsLCBwb3NpdGlvbiwgdG9rZW4pIHtcbiAgICAgICAgdmFyIHdvcmRJbmZvID0gbW9kZWwuZ2V0V29yZFVudGlsUG9zaXRpb24ocG9zaXRpb24pO1xuICAgICAgICB2YXIgcmVzb3VyY2UgPSBtb2RlbC51cmk7XG4gICAgICAgIHJldHVybiB3aXJlQ2FuY2VsbGF0aW9uVG9rZW4odG9rZW4sIHRoaXMuX3dvcmtlcihyZXNvdXJjZSkudGhlbihmdW5jdGlvbiAod29ya2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gd29ya2VyLmRvQ29tcGxldGUocmVzb3VyY2UudG9TdHJpbmcoKSwgZnJvbVBvc2l0aW9uKHBvc2l0aW9uKSk7XG4gICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGluZm8pIHtcbiAgICAgICAgICAgIGlmICghaW5mbykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBpdGVtcyA9IGluZm8uaXRlbXMubWFwKGZ1bmN0aW9uIChlbnRyeSkge1xuICAgICAgICAgICAgICAgIHZhciBpdGVtID0ge1xuICAgICAgICAgICAgICAgICAgICBsYWJlbDogZW50cnkubGFiZWwsXG4gICAgICAgICAgICAgICAgICAgIGluc2VydFRleHQ6IGVudHJ5Lmluc2VydFRleHQsXG4gICAgICAgICAgICAgICAgICAgIHNvcnRUZXh0OiBlbnRyeS5zb3J0VGV4dCxcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyVGV4dDogZW50cnkuZmlsdGVyVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRhdGlvbjogZW50cnkuZG9jdW1lbnRhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgZGV0YWlsOiBlbnRyeS5kZXRhaWwsXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6IHRvQ29tcGxldGlvbkl0ZW1LaW5kKGVudHJ5LmtpbmQpLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKGVudHJ5LnRleHRFZGl0KSB7XG4gICAgICAgICAgICAgICAgICAgIGl0ZW0ucmFuZ2UgPSB0b1JhbmdlKGVudHJ5LnRleHRFZGl0LnJhbmdlKTtcbiAgICAgICAgICAgICAgICAgICAgaXRlbS5pbnNlcnRUZXh0ID0gZW50cnkudGV4dEVkaXQubmV3VGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGVudHJ5Lmluc2VydFRleHRGb3JtYXQgPT09IGxzLkluc2VydFRleHRGb3JtYXQuU25pcHBldCkge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmluc2VydFRleHQgPSB7IHZhbHVlOiBpdGVtLmluc2VydFRleHQgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaXNJbmNvbXBsZXRlOiBpbmZvLmlzSW5jb21wbGV0ZSxcbiAgICAgICAgICAgICAgICBpdGVtczogaXRlbXNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pKTtcbiAgICB9O1xuICAgIHJldHVybiBDb21wbGV0aW9uQWRhcHRlcjtcbn0oKSk7XG5leHBvcnQgeyBDb21wbGV0aW9uQWRhcHRlciB9O1xuZnVuY3Rpb24gaXNNYXJrdXBDb250ZW50KHRoaW5nKSB7XG4gICAgcmV0dXJuIHRoaW5nICYmIHR5cGVvZiB0aGluZyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIHRoaW5nLmtpbmQgPT09ICdzdHJpbmcnO1xufVxuZnVuY3Rpb24gdG9NYXJrZG93blN0cmluZyhlbnRyeSkge1xuICAgIGlmICh0eXBlb2YgZW50cnkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogZW50cnlcbiAgICAgICAgfTtcbiAgICB9XG4gICAgaWYgKGlzTWFya3VwQ29udGVudChlbnRyeSkpIHtcbiAgICAgICAgaWYgKGVudHJ5LmtpbmQgPT09ICdwbGFpbnRleHQnKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBlbnRyeS52YWx1ZS5yZXBsYWNlKC9bXFxcXGAqX3t9W1xcXSgpIytcXC0uIV0vZywgJ1xcXFwkJicpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB2YWx1ZTogZW50cnkudmFsdWVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHsgdmFsdWU6ICdgYGAnICsgZW50cnkubGFuZ3VhZ2UgKyAnXFxuJyArIGVudHJ5LnZhbHVlICsgJ1xcbmBgYFxcbicgfTtcbn1cbmZ1bmN0aW9uIHRvTWFya2VkU3RyaW5nQXJyYXkoY29udGVudHMpIHtcbiAgICBpZiAoIWNvbnRlbnRzKSB7XG4gICAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfVxuICAgIGlmIChBcnJheS5pc0FycmF5KGNvbnRlbnRzKSkge1xuICAgICAgICByZXR1cm4gY29udGVudHMubWFwKHRvTWFya2Rvd25TdHJpbmcpO1xuICAgIH1cbiAgICByZXR1cm4gW3RvTWFya2Rvd25TdHJpbmcoY29udGVudHMpXTtcbn1cbi8vIC0tLSBkZWZpbml0aW9uIC0tLS0tLVxuZnVuY3Rpb24gdG9Mb2NhdGlvbihsb2NhdGlvbikge1xuICAgIHJldHVybiB7XG4gICAgICAgIHVyaTogVXJpLnBhcnNlKGxvY2F0aW9uLnVyaSksXG4gICAgICAgIHJhbmdlOiB0b1JhbmdlKGxvY2F0aW9uLnJhbmdlKVxuICAgIH07XG59XG4vLyAtLS0gZG9jdW1lbnQgc3ltYm9scyAtLS0tLS1cbmZ1bmN0aW9uIHRvU3ltYm9sS2luZChraW5kKSB7XG4gICAgdmFyIG1LaW5kID0gbW9uYWNvLmxhbmd1YWdlcy5TeW1ib2xLaW5kO1xuICAgIHN3aXRjaCAoa2luZCkge1xuICAgICAgICBjYXNlIGxzLlN5bWJvbEtpbmQuRmlsZTogcmV0dXJuIG1LaW5kLkFycmF5O1xuICAgICAgICBjYXNlIGxzLlN5bWJvbEtpbmQuTW9kdWxlOiByZXR1cm4gbUtpbmQuTW9kdWxlO1xuICAgICAgICBjYXNlIGxzLlN5bWJvbEtpbmQuTmFtZXNwYWNlOiByZXR1cm4gbUtpbmQuTmFtZXNwYWNlO1xuICAgICAgICBjYXNlIGxzLlN5bWJvbEtpbmQuUGFja2FnZTogcmV0dXJuIG1LaW5kLlBhY2thZ2U7XG4gICAgICAgIGNhc2UgbHMuU3ltYm9sS2luZC5DbGFzczogcmV0dXJuIG1LaW5kLkNsYXNzO1xuICAgICAgICBjYXNlIGxzLlN5bWJvbEtpbmQuTWV0aG9kOiByZXR1cm4gbUtpbmQuTWV0aG9kO1xuICAgICAgICBjYXNlIGxzLlN5bWJvbEtpbmQuUHJvcGVydHk6IHJldHVybiBtS2luZC5Qcm9wZXJ0eTtcbiAgICAgICAgY2FzZSBscy5TeW1ib2xLaW5kLkZpZWxkOiByZXR1cm4gbUtpbmQuRmllbGQ7XG4gICAgICAgIGNhc2UgbHMuU3ltYm9sS2luZC5Db25zdHJ1Y3RvcjogcmV0dXJuIG1LaW5kLkNvbnN0cnVjdG9yO1xuICAgICAgICBjYXNlIGxzLlN5bWJvbEtpbmQuRW51bTogcmV0dXJuIG1LaW5kLkVudW07XG4gICAgICAgIGNhc2UgbHMuU3ltYm9sS2luZC5JbnRlcmZhY2U6IHJldHVybiBtS2luZC5JbnRlcmZhY2U7XG4gICAgICAgIGNhc2UgbHMuU3ltYm9sS2luZC5GdW5jdGlvbjogcmV0dXJuIG1LaW5kLkZ1bmN0aW9uO1xuICAgICAgICBjYXNlIGxzLlN5bWJvbEtpbmQuVmFyaWFibGU6IHJldHVybiBtS2luZC5WYXJpYWJsZTtcbiAgICAgICAgY2FzZSBscy5TeW1ib2xLaW5kLkNvbnN0YW50OiByZXR1cm4gbUtpbmQuQ29uc3RhbnQ7XG4gICAgICAgIGNhc2UgbHMuU3ltYm9sS2luZC5TdHJpbmc6IHJldHVybiBtS2luZC5TdHJpbmc7XG4gICAgICAgIGNhc2UgbHMuU3ltYm9sS2luZC5OdW1iZXI6IHJldHVybiBtS2luZC5OdW1iZXI7XG4gICAgICAgIGNhc2UgbHMuU3ltYm9sS2luZC5Cb29sZWFuOiByZXR1cm4gbUtpbmQuQm9vbGVhbjtcbiAgICAgICAgY2FzZSBscy5TeW1ib2xLaW5kLkFycmF5OiByZXR1cm4gbUtpbmQuQXJyYXk7XG4gICAgfVxuICAgIHJldHVybiBtS2luZC5GdW5jdGlvbjtcbn1cbmZ1bmN0aW9uIHRvSGlnaGxpZ2hLaW5kKGtpbmQpIHtcbiAgICB2YXIgbUtpbmQgPSBtb25hY28ubGFuZ3VhZ2VzLkRvY3VtZW50SGlnaGxpZ2h0S2luZDtcbiAgICBzd2l0Y2ggKGtpbmQpIHtcbiAgICAgICAgY2FzZSBscy5Eb2N1bWVudEhpZ2hsaWdodEtpbmQuUmVhZDogcmV0dXJuIG1LaW5kLlJlYWQ7XG4gICAgICAgIGNhc2UgbHMuRG9jdW1lbnRIaWdobGlnaHRLaW5kLldyaXRlOiByZXR1cm4gbUtpbmQuV3JpdGU7XG4gICAgICAgIGNhc2UgbHMuRG9jdW1lbnRIaWdobGlnaHRLaW5kLlRleHQ6IHJldHVybiBtS2luZC5UZXh0O1xuICAgIH1cbiAgICByZXR1cm4gbUtpbmQuVGV4dDtcbn1cbnZhciBEb2N1bWVudEhpZ2hsaWdodEFkYXB0ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRG9jdW1lbnRIaWdobGlnaHRBZGFwdGVyKF93b3JrZXIpIHtcbiAgICAgICAgdGhpcy5fd29ya2VyID0gX3dvcmtlcjtcbiAgICB9XG4gICAgRG9jdW1lbnRIaWdobGlnaHRBZGFwdGVyLnByb3RvdHlwZS5wcm92aWRlRG9jdW1lbnRIaWdobGlnaHRzID0gZnVuY3Rpb24gKG1vZGVsLCBwb3NpdGlvbiwgdG9rZW4pIHtcbiAgICAgICAgdmFyIHJlc291cmNlID0gbW9kZWwudXJpO1xuICAgICAgICByZXR1cm4gd2lyZUNhbmNlbGxhdGlvblRva2VuKHRva2VuLCB0aGlzLl93b3JrZXIocmVzb3VyY2UpLnRoZW4oZnVuY3Rpb24gKHdvcmtlcikgeyByZXR1cm4gd29ya2VyLmZpbmREb2N1bWVudEhpZ2hsaWdodHMocmVzb3VyY2UudG9TdHJpbmcoKSwgZnJvbVBvc2l0aW9uKHBvc2l0aW9uKSk7IH0pLnRoZW4oZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgICAgICBpZiAoIWl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gKHtcbiAgICAgICAgICAgICAgICByYW5nZTogdG9SYW5nZShpdGVtLnJhbmdlKSxcbiAgICAgICAgICAgICAgICBraW5kOiB0b0hpZ2hsaWdoS2luZChpdGVtLmtpbmQpXG4gICAgICAgICAgICB9KTsgfSk7XG4gICAgICAgIH0pKTtcbiAgICB9O1xuICAgIHJldHVybiBEb2N1bWVudEhpZ2hsaWdodEFkYXB0ZXI7XG59KCkpO1xuZXhwb3J0IHsgRG9jdW1lbnRIaWdobGlnaHRBZGFwdGVyIH07XG52YXIgRG9jdW1lbnRMaW5rQWRhcHRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBEb2N1bWVudExpbmtBZGFwdGVyKF93b3JrZXIpIHtcbiAgICAgICAgdGhpcy5fd29ya2VyID0gX3dvcmtlcjtcbiAgICB9XG4gICAgRG9jdW1lbnRMaW5rQWRhcHRlci5wcm90b3R5cGUucHJvdmlkZUxpbmtzID0gZnVuY3Rpb24gKG1vZGVsLCB0b2tlbikge1xuICAgICAgICB2YXIgcmVzb3VyY2UgPSBtb2RlbC51cmk7XG4gICAgICAgIHJldHVybiB3aXJlQ2FuY2VsbGF0aW9uVG9rZW4odG9rZW4sIHRoaXMuX3dvcmtlcihyZXNvdXJjZSkudGhlbihmdW5jdGlvbiAod29ya2VyKSB7IHJldHVybiB3b3JrZXIuZmluZERvY3VtZW50TGlua3MocmVzb3VyY2UudG9TdHJpbmcoKSk7IH0pLnRoZW4oZnVuY3Rpb24gKGl0ZW1zKSB7XG4gICAgICAgICAgICBpZiAoIWl0ZW1zKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGl0ZW1zLm1hcChmdW5jdGlvbiAoaXRlbSkgeyByZXR1cm4gKHtcbiAgICAgICAgICAgICAgICByYW5nZTogdG9SYW5nZShpdGVtLnJhbmdlKSxcbiAgICAgICAgICAgICAgICB1cmw6IGl0ZW0udGFyZ2V0XG4gICAgICAgICAgICB9KTsgfSk7XG4gICAgICAgIH0pKTtcbiAgICB9O1xuICAgIHJldHVybiBEb2N1bWVudExpbmtBZGFwdGVyO1xufSgpKTtcbmV4cG9ydCB7IERvY3VtZW50TGlua0FkYXB0ZXIgfTtcbmZ1bmN0aW9uIGZyb21Gb3JtYXR0aW5nT3B0aW9ucyhvcHRpb25zKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdGFiU2l6ZTogb3B0aW9ucy50YWJTaXplLFxuICAgICAgICBpbnNlcnRTcGFjZXM6IG9wdGlvbnMuaW5zZXJ0U3BhY2VzXG4gICAgfTtcbn1cbnZhciBEb2N1bWVudEZvcm1hdHRpbmdFZGl0UHJvdmlkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRG9jdW1lbnRGb3JtYXR0aW5nRWRpdFByb3ZpZGVyKF93b3JrZXIpIHtcbiAgICAgICAgdGhpcy5fd29ya2VyID0gX3dvcmtlcjtcbiAgICB9XG4gICAgRG9jdW1lbnRGb3JtYXR0aW5nRWRpdFByb3ZpZGVyLnByb3RvdHlwZS5wcm92aWRlRG9jdW1lbnRGb3JtYXR0aW5nRWRpdHMgPSBmdW5jdGlvbiAobW9kZWwsIG9wdGlvbnMsIHRva2VuKSB7XG4gICAgICAgIHZhciByZXNvdXJjZSA9IG1vZGVsLnVyaTtcbiAgICAgICAgcmV0dXJuIHdpcmVDYW5jZWxsYXRpb25Ub2tlbih0b2tlbiwgdGhpcy5fd29ya2VyKHJlc291cmNlKS50aGVuKGZ1bmN0aW9uICh3b3JrZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB3b3JrZXIuZm9ybWF0KHJlc291cmNlLnRvU3RyaW5nKCksIG51bGwsIGZyb21Gb3JtYXR0aW5nT3B0aW9ucyhvcHRpb25zKSkudGhlbihmdW5jdGlvbiAoZWRpdHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWVkaXRzIHx8IGVkaXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBlZGl0cy5tYXAodG9UZXh0RWRpdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSkpO1xuICAgIH07XG4gICAgcmV0dXJuIERvY3VtZW50Rm9ybWF0dGluZ0VkaXRQcm92aWRlcjtcbn0oKSk7XG5leHBvcnQgeyBEb2N1bWVudEZvcm1hdHRpbmdFZGl0UHJvdmlkZXIgfTtcbnZhciBEb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRQcm92aWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBEb2N1bWVudFJhbmdlRm9ybWF0dGluZ0VkaXRQcm92aWRlcihfd29ya2VyKSB7XG4gICAgICAgIHRoaXMuX3dvcmtlciA9IF93b3JrZXI7XG4gICAgfVxuICAgIERvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdFByb3ZpZGVyLnByb3RvdHlwZS5wcm92aWRlRG9jdW1lbnRSYW5nZUZvcm1hdHRpbmdFZGl0cyA9IGZ1bmN0aW9uIChtb2RlbCwgcmFuZ2UsIG9wdGlvbnMsIHRva2VuKSB7XG4gICAgICAgIHZhciByZXNvdXJjZSA9IG1vZGVsLnVyaTtcbiAgICAgICAgcmV0dXJuIHdpcmVDYW5jZWxsYXRpb25Ub2tlbih0b2tlbiwgdGhpcy5fd29ya2VyKHJlc291cmNlKS50aGVuKGZ1bmN0aW9uICh3b3JrZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB3b3JrZXIuZm9ybWF0KHJlc291cmNlLnRvU3RyaW5nKCksIGZyb21SYW5nZShyYW5nZSksIGZyb21Gb3JtYXR0aW5nT3B0aW9ucyhvcHRpb25zKSkudGhlbihmdW5jdGlvbiAoZWRpdHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWVkaXRzIHx8IGVkaXRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBlZGl0cy5tYXAodG9UZXh0RWRpdCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSkpO1xuICAgIH07XG4gICAgcmV0dXJuIERvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdFByb3ZpZGVyO1xufSgpKTtcbmV4cG9ydCB7IERvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdFByb3ZpZGVyIH07XG4vKipcbiAqIEhvb2sgYSBjYW5jZWxsYXRpb24gdG9rZW4gdG8gYSBXaW5KUyBQcm9taXNlXG4gKi9cbmZ1bmN0aW9uIHdpcmVDYW5jZWxsYXRpb25Ub2tlbih0b2tlbiwgcHJvbWlzZSkge1xuICAgIGlmIChwcm9taXNlLmNhbmNlbCkge1xuICAgICAgICB0b2tlbi5vbkNhbmNlbGxhdGlvblJlcXVlc3RlZChmdW5jdGlvbiAoKSB7IHJldHVybiBwcm9taXNlLmNhbmNlbCgpOyB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHByb21pc2U7XG59XG4iLCIvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICogIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS4gU2VlIExpY2Vuc2UudHh0IGluIHRoZSBwcm9qZWN0IHJvb3QgZm9yIGxpY2Vuc2UgaW5mb3JtYXRpb24uXG4gKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cbid1c2Ugc3RyaWN0JztcbmltcG9ydCB7IFdvcmtlck1hbmFnZXIgfSBmcm9tICcuL3dvcmtlck1hbmFnZXIuanMnO1xuaW1wb3J0ICogYXMgbGFuZ3VhZ2VGZWF0dXJlcyBmcm9tICcuL2xhbmd1YWdlRmVhdHVyZXMuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIHNldHVwTW9kZShkZWZhdWx0cykge1xuICAgIHZhciBjbGllbnQgPSBuZXcgV29ya2VyTWFuYWdlcihkZWZhdWx0cyk7XG4gICAgdmFyIHdvcmtlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHVyaXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHVyaXNbX2ldID0gYXJndW1lbnRzW19pXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2xpZW50LmdldExhbmd1YWdlU2VydmljZVdvcmtlci5hcHBseShjbGllbnQsIHVyaXMpO1xuICAgIH07XG4gICAgdmFyIGxhbmd1YWdlSWQgPSBkZWZhdWx0cy5sYW5ndWFnZUlkO1xuICAgIC8vIGFsbCBtb2Rlc1xuICAgIG1vbmFjby5sYW5ndWFnZXMucmVnaXN0ZXJDb21wbGV0aW9uSXRlbVByb3ZpZGVyKGxhbmd1YWdlSWQsIG5ldyBsYW5ndWFnZUZlYXR1cmVzLkNvbXBsZXRpb25BZGFwdGVyKHdvcmtlcikpO1xuICAgIG1vbmFjby5sYW5ndWFnZXMucmVnaXN0ZXJEb2N1bWVudEhpZ2hsaWdodFByb3ZpZGVyKGxhbmd1YWdlSWQsIG5ldyBsYW5ndWFnZUZlYXR1cmVzLkRvY3VtZW50SGlnaGxpZ2h0QWRhcHRlcih3b3JrZXIpKTtcbiAgICBtb25hY28ubGFuZ3VhZ2VzLnJlZ2lzdGVyTGlua1Byb3ZpZGVyKGxhbmd1YWdlSWQsIG5ldyBsYW5ndWFnZUZlYXR1cmVzLkRvY3VtZW50TGlua0FkYXB0ZXIod29ya2VyKSk7XG4gICAgLy8gb25seSBodG1sXG4gICAgaWYgKGxhbmd1YWdlSWQgPT09ICdodG1sJykge1xuICAgICAgICBtb25hY28ubGFuZ3VhZ2VzLnJlZ2lzdGVyRG9jdW1lbnRGb3JtYXR0aW5nRWRpdFByb3ZpZGVyKGxhbmd1YWdlSWQsIG5ldyBsYW5ndWFnZUZlYXR1cmVzLkRvY3VtZW50Rm9ybWF0dGluZ0VkaXRQcm92aWRlcih3b3JrZXIpKTtcbiAgICAgICAgbW9uYWNvLmxhbmd1YWdlcy5yZWdpc3RlckRvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdFByb3ZpZGVyKGxhbmd1YWdlSWQsIG5ldyBsYW5ndWFnZUZlYXR1cmVzLkRvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdFByb3ZpZGVyKHdvcmtlcikpO1xuICAgICAgICBuZXcgbGFuZ3VhZ2VGZWF0dXJlcy5EaWFnbm9zdGljc0FkYXB0ZXIobGFuZ3VhZ2VJZCwgd29ya2VyLCBkZWZhdWx0cyk7XG4gICAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==